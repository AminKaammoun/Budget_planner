<div class="grid-container">
  <h1 class="mat-h1">Dashboard</h1>
  <mat-grid-list cols="2" rowHeight="390px">
    <mat-grid-tile *ngFor="let card of cards | async" [colspan]="card.cols" [rowspan]="card.rows">
      <mat-card class="dashboard-card">
        <mat-card-header>  
          <div mat-card-avatar class={{card.img}}></div>
          <mat-card-title>
            {{card.title}}
            <button mat-icon-button class="more-button" aria-label="Toggle menu">
              <mat-icon>more_vert</mat-icon>
            </button>
          
          </mat-card-title>
          <mat-card-subtitle>{{card.subtitle}}</mat-card-subtitle>
          
        </mat-card-header>
        <hr style="border: none; border-top: 1px solid black; width: 90%;">
        <mat-card-content class="dashboard-card-content">
          
        
          <div *ngIf="card.title === 'Income'" style="position: relative;">
            <mat-card-content style="display: flex; flex-direction: column; align-items: center;">
              <b><p style="font-size: 18px; margin-bottom: 10px;">Last Few Months</p></b>
              <div fxLayout="row" fxLayoutAlign="space-between center">
              <mat-list role="list" style="width: 100%; margin-right: 200px;" >
                <mat-list-item role="listitem">{{ getPreviousMonth(-3) }} : {{ monthTotals[getPreviousMonth(-3)].income }} DT</mat-list-item>
                <mat-list-item role="listitem">{{ getPreviousMonth(-2) }} : {{ monthTotals[getPreviousMonth(-2)].income }} DT</mat-list-item>
                <mat-list-item role="listitem">{{ getPreviousMonth(-1) }} : {{ monthTotals[getPreviousMonth(-1)].income }} DT</mat-list-item>
              </mat-list>
              <mat-list role="list" style="width: 100%;">
                <mat-list-item role="listitem"><b>Total Income : <span style="color: green;">{{totalIncome }} DT</span></b></mat-list-item>
               
              </mat-list>
              </div>
              <b><p style="font-size: 18px; margin-top: 20px;">Current Month ({{getCurrentMonth()}}) : <span style="color: green;">{{ monthTotals[currentMonth].income }} DT</span></p></b>
            </mat-card-content>
            <mat-card-actions style="position: absolute; bottom: 0; right: 0;">
              <button mat-button style="color: white; background-color: blue;">VIEW</button>
            </mat-card-actions>
          </div>
          
          
       
          <div *ngIf="card.title === 'Expense'" style="position: relative;">
            <mat-card-content style="display: flex; flex-direction: column; align-items: center;">
              <b><p style="font-size: 18px; margin-bottom: 10px;">Last Few Months</p></b>
              <div fxLayout="row" fxLayoutAlign="space-between center">
              <mat-list role="list" style="width: 100%;">
                <mat-list-item role="listitem">{{getPreviousMonth(-3)}} : -{{ monthTotals[getPreviousMonth(-3)].expense }} DT</mat-list-item>
                <mat-list-item role="listitem">{{getPreviousMonth(-2)}} : -{{ monthTotals[getPreviousMonth(-2)].expense }} DT</mat-list-item>
                <mat-list-item role="listitem">{{getPreviousMonth(-1)}} : -{{ monthTotals[getPreviousMonth(-1)].expense }} DT</mat-list-item>
              </mat-list>
              <mat-list role="list" style="width: 100%;margin-left: 200px;">
                <mat-list-item role="listitem"><b>Total Expense : <span style="color: red;">-{{totalExpense }} DT</span></b></mat-list-item>
               
              </mat-list>
            </div>
              <b><p style="font-size: 18px; margin-top: 20px;">Current Month ({{getCurrentMonth()}}) : <span style="color: red;"> -{{monthTotals[currentMonth].expense}} DT</span></p></b>
            </mat-card-content>
            <mat-card-actions style="position: absolute; bottom: 0; right: 0;">
              <button mat-button style="color: white; background-color: blue;">VIEW</button>
            </mat-card-actions>
          </div>
          

          <div *ngIf="card.title === ''" style="position: relative;">
            <mat-card-content style="display: flex; flex-direction: column; align-items: center;">
              <div>
               
                
              </div>
            </mat-card-content>
           
          </div>



          <div *ngIf="card.title === 'Expense By Category ('+currentMonth +')'" style="position: relative;">
            <br>  <br>  <br>  <br>  <br>
            <mat-card-content style="display: flex; flex-direction: column; align-items: center;">
             
              <div fxLayout="row" fxLayoutAlign="space-around center" >  
              <div class="chart-wrapper">
                  <canvas baseChart
                          [type]="'pie'"
                    [datasets]="chartData"
                    [labels]="chartLabels"
                    [options]="chartOptions"
                    >
                  </canvas>
                </div>
                <br>
               
                <div>
                  <table border="1px">
                    <tr>
                      <th>Category</th>
                      <th>Amount Spent</th>
                      <th>(%)</th>
                    </tr>
                    
                    <tr *ngFor="let item of categories">
                      <td>{{ item.name }}</td>
                      <td>{{expenseByCategory[item.name].expense}} DT</td>
                      <td>{{ ((expenseByCategory[item.name].expense / monthTotals[currentMonth].expense) * 100) | number: '1.2-2' }}%</td>

                    </tr>
                  </table>
                </div>
                </div>
            </mat-card-content>
           
          </div>

          
          
       
        </mat-card-content>
      </mat-card>
    </mat-grid-tile>
  </mat-grid-list>
</div>
